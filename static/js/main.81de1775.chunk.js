(this["webpackJsonpreact-template"]=this["webpackJsonpreact-template"]||[]).push([[0],{53:function(e,t,a){e.exports=a(67)},58:function(e,t,a){},59:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(14),i=a.n(o),c=(a(58),a(59),a(11));function s(e){return{type:"SET_SCENE",_change_scene:e}}var l=a(85),u=a(87),d=a(33),m=Object(l.a)((function(e){return{root:{width:"100%"},ContentsBody:{position:"absolute",width:"100%",left:"0px",top:"0px",bottom:"50px"},BottomBar1:{position:"absolute",width:"40%",Height:"50px",left:"5%",bottom:"0px"},BottomBar2:{position:"absolute",width:"40%",left:"55%",Height:"50px",bottom:"0px"}}})),p={set_scene:s},v=Object(c.b)((function(e){return{_current_scene:e.scene._current_scene}}),p)((function(e){e._current_scene;var t=e.set_scene;console.log("Index_scene component start");var a=m();return n.a.createElement("div",{className:a.root},n.a.createElement("div",{className:a.ContentsBody},n.a.createElement(d.a,{url:"https://m.blog.naver.com/elanvital7/221026487974",position:"absolute",width:"100%",id:"myId",className:"myClassname",height:"100%",styles:{height:"25px"}})),n.a.createElement(u.a,{onClick:function(){t("CameraCapture"),console.log("onCameraCapture")},className:a.BottomBar1,variant:"contained",color:"secondary"},"\uc0ac\uc9c4 \ucc0d\uae30"),n.a.createElement(u.a,{onClick:function(){console.log("onCameraCaptureSubmit")},className:a.BottomBar2,variant:"contained",color:"secondary"},"\uc81c\ucd9c\ud558\uae30"))})),h=a(13),f=a.n(h),g=a(23),b=a(34),y=a(35),C=a(22),w=a(50),E=a(49);var _=a(88),k=a(36),x=a.n(k),T=a(38),O=a.n(T),S=a(37),j=a.n(S),D=a(44),z=a.n(D),A=a(45),N=a.n(A),B=a(41),I=a.n(B),F=a(39),V=a.n(F),M=a(40),L=a.n(M),R=a(42),P=a.n(R),U=a(43),G=a.n(U),W=0,H=[],X={color:"red",position:"fixed",left:"0px",top:"50px",width:"100%",transform:"scale(1.5)",webkitTransform:"scale(1.5)"},J={color:"red",position:"fixed",left:"0px",bottom:"50px",width:"100%",transform:"scale(1.5)",webkitTransform:"scale(1.5)"},q=function(e){Object(w.a)(a,e);var t=Object(E.a)(a);function a(e){var r;return Object(b.a)(this,a),(r=t.call(this,e,a.defaultProps)).getCanvas=function(e){r.canvas=e},r.getCanvasOverlay=function(e){r.canvasOverlay=e},r.getVideo=function(e){r.video=e},r.updateCameraGrid=function(e){var t=r.canvasOverlay;if(void 0!=t){var a=t.getContext("2d");if(void 0!=a&&(a.clearRect(0,0,t.width,t.height),1==e)){a.save(),a.strokeStyle="rgb(200,200,200)",a.lineWidth=3,a.globalAlpha=.1;for(var n=0;n<=t.width;n+=100)a.moveTo(n,0),a.lineTo(n,t.height);for(var o=0;o<=t.height;o+=100)a.moveTo(0,o),a.lineTo(t.width,o);a.stroke(),a.restore()}}},r.onNextCamera=function(){W++,H.length<=W&&(W=0),console.log("camera index : "+W),r.playCamera()},r.onTimerSelect=function(){var e=r.state.cameraCaptureTimerType;++e>2&&(e=0),r.setState((function(){return{cameraCaptureTimerType:e}})),console.log("timer:"+e)},r.onCapture=function(){var e=r.canvas;if(void 0!=e){var t=0;switch(r.state.cameraCaptureTimerType){case 0:t=0;break;case 1:t=3e3;break;case 2:t=1e4}setTimeout((function(){var t=e.toDataURL("image/jpeg",1);this.props.onAddCanvasData(t),console.log("onCapture")}),t)}},r.onBack=function(){console.log("onBack")},r.onFlash=function(){var e=r.state.cameraFlashType;++e>1&&(e=0),r.setState((function(){return{cameraFlashType:e}})),console.log("flash:"+e)},r.onToggleGrid=function(){var e=!r.state.gridView;r.setState((function(){return{gridView:e}})),console.log("grid view:"+e),r.updateCameraGrid(e)},r.onMovieFilter=function(){var e=r.state.cameraFilterType;++e>7&&(e=0),r.setState((function(){return{cameraFilterType:e}})),console.log("camera filter:"+e)},r.resize=r.resize.bind(Object(C.a)(r)),r.stopCamera=r.stopCamera.bind(Object(C.a)(r)),r.state={cameraCaptureTimerType:0,cameraFlashType:0,cameraFilterType:0,gridView:!1},r}return Object(y.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resize(),e.prev=1,e.next=4,this.setupCamera();case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error("This browser does not support video capture, or this device does not have a camera");case 9:window.addEventListener("resize",this.resize);case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"resize",value:function(){console.log("resize start");var e=this.video;if(void 0!=e){var t=this.canvas;if(void 0!=t){var a=this.canvasOverlay;if(void 0!=a){var r=window.innerWidth,n=window.innerHeight;console.log("resize apply:"+r+","+n),e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.left=0,e.top=0,e.width=r,e.height=n,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.width=r,t.height=n,a.style.position="fixed",a.style.left="0px",a.style.top="0px",a.width=r,a.height=n}}}}},{key:"setupCamera",value:function(){var e=Object(g.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=2;break}throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");case 2:navigator.mediaDevices.enumerateDevices().then((function(e){e.forEach((function(e){"videoinput"===e.kind&&H.push(e.deviceId),console.log(e.kind+": "+e.label+" id = "+e.deviceId)}))})).catch((function(e){console.log(e.name+": "+e.message)})),this.playCamera(),this.updateCamera();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"playCamera",value:function(){var e=Object(g.a)(f.a.mark((function e(){var t,a,r,n,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.stream&&window.stream.getTracks().forEach((function(e){e.stop()})),(t=this.video).style.transform="rotatey(180deg)",a=H[W],console.log("videoSource:"+a),r=t.width,n=t.height,e.next=9,navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:a?{exact:a}:void 0,facingMode:"environment",frameRate:60,width:r,height:n}});case 9:o=e.sent,window.stream=o,t.srcObject=o,t.play();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopCamera",value:function(){console.log("stopCamera call");var e=this.video;void 0!=e&&(e.pause(),e.src="",void 0!=e.srcObject&&(e.srcObject.getTracks()[0].stop(),e.srcObject=void 0),this.props.onPosenetPose(void 0),console.log("video off"))}},{key:"updateCamera",value:function(){var e=this.canvas;if(void 0!=e){var t=e.getContext("2d");if(void 0!=t){var a=this.video;void 0!=a&&(0==this.props.showVideo?a.style.display="none":a.style.display="block",this.updateCameraFrame(t))}}}},{key:"updateCameraFrame",value:function(e){var t=this,a=this.video,r=function(){var n=Object(g.a)(f.a.mark((function n(){var o;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.canvas,1!=t.props.showDebugVideo||void 0==o){n.next=27;break}e.clearRect(0,0,o.width,o.height),e.save(),n.t0=t.state.cameraFilterType,n.next=0===n.t0?7:1===n.t0?9:2===n.t0?11:3===n.t0?13:4===n.t0?15:5===n.t0?17:6===n.t0?19:7===n.t0?21:23;break;case 7:return e.filter="none",n.abrupt("break",23);case 9:return e.filter="grayscale(100%)",n.abrupt("break",23);case 11:return e.filter="brightness(100%)",n.abrupt("break",23);case 13:return e.filter="contrast(100%)",n.abrupt("break",23);case 15:return e.filter="sepia(100%)",n.abrupt("break",23);case 17:return e.filter="invert(100%)",n.abrupt("break",23);case 19:return e.filter="saturate(100%)",n.abrupt("break",23);case 21:return e.filter="blur(4px)",n.abrupt("break",23);case 23:e.scale(-1,1),e.translate(-a.width,0),e.drawImage(a,a.left,a.top,a.width,a.height),e.restore();case 27:if("start"!=t.props._closeCamera){n.next=31;break}return t.stopCamera(),t.props.onCloseCamera("complete"),n.abrupt("return");case 31:requestAnimationFrame(r);case 32:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();r()}},{key:"render",value:function(){var e,t;switch(this.state.cameraCaptureTimerType){case 0:e=n.a.createElement(x.a,{color:"primary",fontSize:"large"});break;case 1:e=n.a.createElement(j.a,{color:"primary",fontSize:"large"});break;case 2:e=n.a.createElement(O.a,{color:"primary",fontSize:"large"})}switch(this.state.cameraFlashType){case 0:t=n.a.createElement(V.a,{color:"primary",fontSize:"large"});break;case 1:t=n.a.createElement(L.a,{color:"primary",fontSize:"large"})}return n.a.createElement("div",{style:{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}},n.a.createElement("video",{id:"videoCamera",style:{zIndex:"-2"},src:"",playsInline:!0,ref:this.getVideo}),n.a.createElement("canvas",{style:{position:"fixed",left:"0%",top:"0%",zIndex:"-1"},ref:this.getCanvas}),n.a.createElement("canvas",{id:"canvasOverlay",style:{position:"fixed",left:"0%",top:"0%",zIndex:"-1"},ref:this.getCanvasOverlay}),n.a.createElement("div",{style:X},n.a.createElement(_.a,{onClick:this.onBack.bind(this)},n.a.createElement(I.a,{color:"primary",fontSize:"large"})),n.a.createElement(_.a,{onClick:this.onFlash.bind(this)},t),n.a.createElement(_.a,{onClick:this.onToggleGrid.bind(this)},n.a.createElement(P.a,{color:"primary",fontSize:"large"})),n.a.createElement(_.a,{onClick:this.onMovieFilter.bind(this)},n.a.createElement(G.a,{color:"primary",fontSize:"large"}))),n.a.createElement("div",{style:J},n.a.createElement(_.a,{onClick:this.onTimerSelect.bind(this)},e),n.a.createElement(_.a,{onClick:this.onCapture.bind(this)},n.a.createElement(z.a,{color:"primary",fontSize:"large"})),n.a.createElement(_.a,{onClick:this.onNextCamera.bind(this)},n.a.createElement(N.a,{color:"primary",fontSize:"large"}))))}}]),a}(r.Component);q.defaultProps={showVideo:!1,showDebugVideo:!0,loadingText:"Loading...please be patient..."};var $=q=Object(c.b)((function(e){return{_current_scene:e.scene._current_scene,_closeCamera:e.camera._closeCamera}}),(function(e){return{onCloseCamera:function(t){return e({type:"CLOSECAMERA",_closeCamera:t})},onAddCanvasData:function(t){return e({type:"ADDCANVASDATA",_addCanvasData:t})}}}))(q),K=a(48),Q=a(89),Y=a(90),Z=a(47),ee=a.n(Z),te=a(46),ae=a.n(te),re=Object(l.a)({root:{width:"100%",bottom:0,position:"fixed",flexGrow:1}}),ne={set_scene:s},oe=Object(c.b)((function(e){return{_current_scene:e.scene._current_scene}}),ne)((function(e){e._current_scene;var t=e.set_scene,a=re(),r=n.a.useState(0),o=Object(K.a)(r,2),i=o[0],c=o[1];return n.a.createElement(Q.a,{value:i,onChange:function(e,a){t(a),c(a)},showLabels:!0,className:a.root},n.a.createElement(Y.a,{value:"PortraitMaster",label:"Home",icon:n.a.createElement(ae.a,null)}),n.a.createElement(Y.a,{value:"CameraCapture",label:"\uc0ac\uc9c4\ucc0d\uae30",icon:n.a.createElement(ee.a,null)}))})),ie=Object(l.a)((function(e){return{root:{"& > *":{width:"100%"}}}})),ce={set_scene:s},se=Object(c.b)((function(e){return{_current_scene:e.scene._current_scene}}),ce)((function(e){var t=e._current_scene;e.set_scene;console.log("Index_scene component start");var a=ie();return n.a.createElement("div",{className:a.root},function(){switch(t){case"CameraCapture":return n.a.createElement($,null);case"PortraitMaster":return n.a.createElement(v,null);default:return n.a.createElement(oe,null)}}())}));var le=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(se,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=a(15),de={_current_scene:"IndexScene"};var me={_closeCamera:""};var pe=Object(ue.b)({scene:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(console.log("reducer scene action call:"+t.type),t.type){case"SET_SCENE":return console.log("SET_SCENE:"+t._change_scene),Object.assign({},e,{_current_scene:t._change_scene});default:return e}},camera:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(console.log("reducer scene action call:"+t.type),t.type){case"CLOSECAMERA":return console.log("CLOSECAMERA:"+t._closeCamera),Object.assign({},e,{_closeCamera:t._closeCamera});case"ADDCANVASDATA":default:return e}}}),ve=document.getElementById("root"),he=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),fe=Object(ue.c)(pe,he);i.a.render(n.a.createElement(c.a,{store:fe},n.a.createElement(le,null)),ve),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.81de1775.chunk.js.map